---
name: triggering tests and waiting for result
on:
  push:

jobs:
  test:
    name: Test
    timeout-minutes: 10

    runs-on: ubuntu-latest

    steps:
      - name: show github obj
        run: echo ${{ github }}

      - name: dispatching a workflow
        run: |
          curl \
          -X POST \
          -H "Accept: application/vnd.github.v3+json" \
          -H "Authorization: token ${{ secrets.ROBOT_TOKEN }}" \
          https://api.github.com/repos/percona-platform/saas-ui/actions/workflows/test.yml/dispatches \
          -d '{
                "ref":"${{ github.ref }}",
                "inputs": {
                  "branch": "${{ github.ref }}",
                  "repo": "${{ github.repository }}",
                  "run_id": "${{ github.run_id }}"
                }
              }'

      - name: sleep
        run: sleep 5m
